# ğŸ§  MCP åŸºæœ¬æ¦‚å¿µ

Model Context Protocol (MCP) ã®æ ¸ã¨ãªã‚‹æ¦‚å¿µã‚’ç†è§£ã—ã¾ã—ã‚‡ã†ã€‚

## ğŸ— ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦

MCPã¯ **ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ»ã‚µãƒ¼ãƒãƒ¼** ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’æ¡ç”¨ã—ã¦ã„ã¾ã™ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   MCPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ  â”‚                    â”‚   MCPã‚µãƒ¼ãƒãƒ¼    â”‚
â”‚                 â”‚                    â”‚                 â”‚
â”‚  â€¢ Claude       â”‚     JSON-RPC      â”‚  â€¢ ãƒ„ãƒ¼ãƒ«        â”‚
â”‚  â€¢ ãã®ä»–ã®LLM   â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  â€¢ ãƒªã‚½ãƒ¼ã‚¹      â”‚
â”‚  â€¢ ã‚«ã‚¹ã‚¿ãƒ ã‚¢ãƒ—ãƒª â”‚                    â”‚  â€¢ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ ã‚³ã‚¢æ©Ÿèƒ½

### 1. ãƒ„ãƒ¼ãƒ« (Tools)

**å®šç¾©**: LLMãŒå®Ÿè¡Œã§ãã‚‹é–¢æ•°ã‚„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³

**ç‰¹å¾´**:
- å‹•çš„ãªæ“ä½œã‚’å¯èƒ½ã«ã™ã‚‹
- å¼•æ•°ã‚’å—ã‘å–ã‚Šã€çµæœã‚’è¿”ã™
- å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ ã¨ã®ç›¸äº’ä½œç”¨

**ä¾‹**:
```javascript
{
  name: "calculate",
  description: "æ•°å­¦çš„è¨ˆç®—ã‚’å®Ÿè¡Œ",
  inputSchema: {
    type: "object",
    properties: {
      expression: {
        type: "string",
        description: "è¨ˆç®—å¼ï¼ˆä¾‹: 2 + 2ï¼‰"
      }
    }
  }
}
```

### 2. ãƒªã‚½ãƒ¼ã‚¹ (Resources)

**å®šç¾©**: ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ãªãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹

**ç‰¹å¾´**:
- é™çš„ã¾ãŸã¯å‹•çš„ãªã‚³ãƒ³ãƒ†ãƒ³ãƒ„
- ãƒ•ã‚¡ã‚¤ãƒ«ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã€APIå¿œç­”ãªã©
- èª­ã¿å–ã‚Šå°‚ç”¨ã¾ãŸã¯èª­ã¿æ›¸ãå¯¾å¿œ

**ä¾‹**:
```javascript
{
  uri: "file:///docs/readme.txt",
  name: "ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ README",
  description: "ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®èª¬æ˜æ–‡æ›¸",
  mimeType: "text/plain"
}
```

### 3. ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ (Prompts)

**å®šç¾©**: å†åˆ©ç”¨å¯èƒ½ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

**ç‰¹å¾´**:
- æ¨™æº–åŒ–ã•ã‚ŒãŸLLMã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³
- ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åŒ–ã•ã‚ŒãŸãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
- ä¸€è²«ã—ãŸå¿œç­”å“è³ª

**ä¾‹**:
```javascript
{
  name: "code-review",
  description: "ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ",
  arguments: [
    {
      name: "code",
      description: "ãƒ¬ãƒ“ãƒ¥ãƒ¼ã™ã‚‹ã‚³ãƒ¼ãƒ‰",
      required: true
    }
  ]
}
```

## ğŸ”„ é€šä¿¡ãƒ—ãƒ­ãƒˆã‚³ãƒ«

### JSON-RPC 2.0

MCPã¯ **JSON-RPC 2.0** ã‚’ä½¿ç”¨ã—ã¦é€šä¿¡ã—ã¾ã™ï¼š

```json
{
  "jsonrpc": "2.0",
  "id": 1,
  "method": "tools/call",
  "params": {
    "name": "hello",
    "arguments": {
      "name": "ä¸–ç•Œ"
    }
  }
}
```

### ä¸»è¦ãªãƒ¡ã‚½ãƒƒãƒ‰

| ãƒ¡ã‚½ãƒƒãƒ‰ | èª¬æ˜ | ä¾‹ |
|---------|------|---|
| `tools/list` | åˆ©ç”¨å¯èƒ½ãªãƒ„ãƒ¼ãƒ«ä¸€è¦§ã‚’å–å¾— | ãƒ„ãƒ¼ãƒ«ç™ºè¦‹ |
| `tools/call` | ç‰¹å®šã®ãƒ„ãƒ¼ãƒ«ã‚’å®Ÿè¡Œ | è¨ˆç®—å®Ÿè¡Œ |
| `resources/list` | åˆ©ç”¨å¯èƒ½ãªãƒªã‚½ãƒ¼ã‚¹ä¸€è¦§ã‚’å–å¾— | ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§ |
| `resources/read` | ãƒªã‚½ãƒ¼ã‚¹ã®å†…å®¹ã‚’èª­ã¿å–ã‚Š | ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ |
| `prompts/list` | åˆ©ç”¨å¯èƒ½ãªãƒ—ãƒ­ãƒ³ãƒ—ãƒˆä¸€è¦§ã‚’å–å¾— | ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç™ºè¦‹ |
| `prompts/get` | ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’å–å¾— | ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä½¿ç”¨ |

## ğŸš› ãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆæ–¹å¼

### 1. Stdio ãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆ

**ç”¨é€”**: ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºã€ã‚·ãƒ³ãƒ—ãƒ«ãªçµ±åˆ
**æ¥ç¶š**: æ¨™æº–å…¥åŠ›/å‡ºåŠ›
**åˆ©ç‚¹**: ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãŒç°¡å˜

```javascript
import { StdioServerTransport } from '@modelcontextprotocol/sdk/server/stdio.js';

const transport = new StdioServerTransport();
await server.connect(transport);
```

### 2. HTTP ãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆ

**ç”¨é€”**: Web ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã€ãƒªãƒ¢ãƒ¼ãƒˆã‚µãƒ¼ãƒãƒ¼
**æ¥ç¶š**: HTTP/HTTPS
**åˆ©ç‚¹**: åºƒç¯„å›²ãªäº’æ›æ€§

```javascript
import { HTTPServerTransport } from '@modelcontextprotocol/sdk/server/http.js';

const transport = new HTTPServerTransport({
  port: 3000
});
```

### 3. WebSocket ãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆ

**ç”¨é€”**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡
**æ¥ç¶š**: WebSocket
**åˆ©ç‚¹**: åŒæ–¹å‘é€šä¿¡ã€ä½é…å»¶

## ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è€ƒæ…®äº‹é …

### æ¨©é™ç®¡ç†

- **æœ€å°æ¨©é™ã®åŸå‰‡**: å¿…è¦æœ€å°é™ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã®ã¿ä»˜ä¸
- **å…¥åŠ›æ¤œè¨¼**: ã™ã¹ã¦ã®å…¥åŠ›ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ¤œè¨¼
- **å‡ºåŠ›ã‚µãƒ‹ã‚¿ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³**: æ©Ÿå¯†æƒ…å ±ã®æ¼æ´©ã‚’é˜²æ­¢

### èªè¨¼ã¨èªå¯

```javascript
// åŸºæœ¬çš„ãªèªè¨¼ä¾‹
server.setRequestHandler(CallToolRequestSchema, async (request) => {
  // èªè¨¼ãƒã‚§ãƒƒã‚¯
  if (!isAuthorized(request)) {
    throw new Error('èªè¨¼ãŒå¿…è¦ã§ã™');
  }
  
  // ãƒ„ãƒ¼ãƒ«å®Ÿè¡Œ
  return executetool(request.params);
});
```

## ğŸ“Š ãƒ‡ãƒ¼ã‚¿å‹

### ã‚¹ã‚­ãƒ¼ãƒå®šç¾©

MCPã¯ **JSON Schema** ã‚’ä½¿ç”¨ã—ã¦ãƒ‡ãƒ¼ã‚¿å‹ã‚’å®šç¾©ï¼š

```javascript
{
  type: "object",
  properties: {
    name: {
      type: "string",
      description: "ãƒ¦ãƒ¼ã‚¶ãƒ¼å",
      minLength: 1
    },
    age: {
      type: "integer",
      minimum: 0,
      maximum: 150
    },
    email: {
      type: "string",
      format: "email"
    }
  },
  required: ["name", "email"]
}
```

### ã‚ˆãä½¿ç”¨ã•ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿å‹

- **string**: æ–‡å­—åˆ—
- **integer**: æ•´æ•°
- **number**: æ•°å€¤
- **boolean**: çœŸå½å€¤
- **array**: é…åˆ—
- **object**: ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ

## ğŸ¯ ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### ã€ãƒ„ãƒ¼ãƒ«è¨­è¨ˆã€

1. **å˜ä¸€è²¬ä»»**: 1ã¤ã®ãƒ„ãƒ¼ãƒ«ã¯1ã¤ã®è²¬ä»»ã®ã¿
2. **æ˜ç¢ºãªå‘½å**: ãƒ„ãƒ¼ãƒ«åã¨èª¬æ˜ã‚’æ˜ç¢ºã«
3. **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: é©åˆ‡ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
4. **å‹å®‰å…¨æ€§**: å³å¯†ãªå…¥åŠ›ã‚¹ã‚­ãƒ¼ãƒ

### ã€ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†ã€

1. **åŠ¹ç‡çš„ãªã‚¢ã‚¯ã‚»ã‚¹**: å¿…è¦ãªãƒ‡ãƒ¼ã‚¿ã®ã¿å–å¾—
2. **ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ´»ç”¨**: é »ç¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã•ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥
3. **æ›´æ–°é€šçŸ¥**: ãƒ‡ãƒ¼ã‚¿å¤‰æ›´æ™‚ã®é€šçŸ¥æ©Ÿèƒ½

### ã€ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆè¨­è¨ˆã€

1. **å†åˆ©ç”¨æ€§**: æ±ç”¨çš„ãªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä½œæˆ
2. **ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åŒ–**: æŸ”è»Ÿæ€§ã®ã‚ã‚‹è¨­è¨ˆ
3. **æ˜ç¢ºãªæŒ‡ç¤º**: æ›–æ˜§ã•ã®ãªã„æŒ‡ç¤ºæ–‡

## ğŸ” å®Ÿè£…ä¾‹

### ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ•ã‚¡ã‚¤ãƒ«ã‚µãƒ¼ãƒãƒ¼

```javascript
server.setRequestHandler(ListResourcesRequestSchema, async () => {
  return {
    resources: [
      {
        uri: "file:///docs/readme.md",
        name: "README",
        description: "ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆèª¬æ˜",
        mimeType: "text/markdown"
      }
    ]
  };
});

server.setRequestHandler(ReadResourceRequestSchema, async (request) => {
  const { uri } = request.params;
  
  if (uri === "file:///docs/readme.md") {
    const content = await fs.readFile('./docs/readme.md', 'utf8');
    return {
      contents: [
        {
          uri,
          mimeType: "text/markdown",
          text: content
        }
      ]
    };
  }
  
  throw new Error(`ãƒªã‚½ãƒ¼ã‚¹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: ${uri}`);
});
```

ã“ã‚Œã‚‰ã®æ¦‚å¿µã‚’ç†è§£ã™ã‚‹ã“ã¨ã§ã€åŠ¹æœçš„ãªMCPã‚µãƒ¼ãƒãƒ¼ã‚’æ§‹ç¯‰ã§ãã¾ã™ã€‚